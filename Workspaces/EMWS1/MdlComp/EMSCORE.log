*------------------------------------------------------------*
* Score Log
Date:                2024年01月07日
Time:                16时36分17秒
*------------------------------------------------------------*
11376  /* Generate assessment metadata, which will be used to generate assessment data step */
11377  /* code, such as retrieving names of temporary variables and summary variables,      */
11378  /* labels, etc.  It is used in almost all the assessment computations such as lift,  */
11379  /* roc, index, scoreDist and could be thought as a global variable in assessment     */
11380  /* computation.                                                                      */
11381  data work.ASSESS_29EHERW_assessMeta_2vch4Z;
11382  length VARIABLE $32 FORMAT $44 TYPE $32 PARENT $32 LEVEL $32 PROPERTY $32 MEASUREMENT $10 LAST_LEVEL $32 GEN_VAR_IN_TEMP_DATA $32 RESULT_MEAN $32 RESULT_MEAN_LABEL $100 RESULT_MIN $32 RESULT_MIN_LABEL $100 MIN_ADJUSTED $32 RESULT_MAX $32
11382! RESULT_MAX_LABEL
11383     $100 MAX_ADJUSTED $32 RESULT_COUNT $32 RESULT_COUNT_LABEL $100 TEMPORARY_VARIABLE $32;
11384  VARIABLE = "Age";
11385  PARENT = "";
11386  FORMAT = "";
11387  TYPE = "";
11388  LEVEL = '';
11389  PROPERTY = "TARGET";
11390  MEASUREMENT = "INTERVAL";
11391  LAST_LEVEL = '';
11392  GEN_VAR_IN_TEMP_DATA = "Age";
11393  RESULT_MEAN = "_targetMean_";
11394  RESULT_MEAN_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_trgtMean_vlabel, NOQUOTE))";
11395  RESULT_MIN = "_targetMin_";
11396  RESULT_MIN_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_trgtMin_vlabel, NOQUOTE))";
11397  MIN_ADJUSTED = "Age_minAdjusted_pFwWZ4Fqe";
11398  RESULT_MAX = "_targetMax_";
11399  RESULT_MAX_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_trgtMax_vlabel, NOQUOTE))";
11400  MAX_ADJUSTED = "Age_maxAdjusted_oT_KIhwU6";
11401  RESULT_COUNT = "";
11402  RESULT_COUNT_LABEL = "";
11403  TEMPORARY_VARIABLE = "Age_2E6LvbjHeAIFx9O";
11404  output;
11405  VARIABLE = "P_Age";
11406  FORMAT = "";
11407  TYPE = "";
11408  PARENT = "";
11409  LEVEL = "";
11410  PROPERTY = "PREDICTED";
11411  MEASUREMENT = "INTERVAL";
11412  LAST_LEVEL = "";
11413  GEN_VAR_IN_TEMP_DATA = "P_Age";
11414  RESULT_MEAN = "_meanP_";
11415  RESULT_MEAN_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_predMean_vlabel, NOQUOTE))";
11416  RESULT_MIN = "_minP_";
11417  RESULT_MIN_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_predMin_vlabel, NOQUOTE))";
11418  MIN_ADJUSTED = "P_Age_minAdjusted_OPhzR0_Pf";
11419  RESULT_MIN_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_predMin_vlabel, NOQUOTE))";
11420  RESULT_MAX = "_maxP_";
11421  RESULT_MAX_LABEL = "%sysfunc(sasmsg(sashelp.dmine, assmt_predMax_vlabel, NOQUOTE))";
11422  MAX_ADJUSTED = "max_adjusted";
11423  RESULT_COUNT = "";
11424  RESULT_COUNT_LABEL = "";
11425  TEMPORARY_VARIABLE = "P_Age_7pMnynrZrHlzDs4";
11426  output;
11427  run;

NOTE: The data set WORK.ASSESS_29EHERW_ASSESSMETA_2VCH4Z has 2 observations and 20 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11428  /* Generate temporary dataset and obtain summary statistics such as total number of   */
11429  /* obserations, frequency of target.  However, summary statistics for class reporting */
11430  /* variabels are not computed here since if there exist class reporting variables,    */
11431  /* then PROC DMDB will be called. And there is no need to compute interval reporting  */
11432  /* summary statisitcs, if any.                                                        */
11433  data work.ASSESS_29EHERW_normSD_JGIjNF(drop=
11434  _numberOfObservation_
11435  _intervalTargetMin_ _intervalTargetMax_
11436  )
11437  work.ASSESS_29EHERW_meansAndTi_ajLJtX (keep=
11438  _numberOfObservation_
11439  _intervalTargetMin_ _intervalTargetMax_
11440  );
11441  set EMWS1.HPDMForest_TRAIN(
11442  where=(
11443  (Age ^= .)
11444  and (P_Age ^= .)
11445  )
11446  ) end=_lastObservation_;
11447  keep frequency_i8__Ej;
11448  frequency_i8__Ej = 1;
11449  keep Age;
11450  keep P_Age;
11451  output work.ASSESS_29EHERW_normSD_JGIjNF;
11452  keep _numberOfObservation_;
11453  retain _numberOfObservation_ 0;
11454  _numberOfObservation_ + frequency_i8__Ej;
11455  keep _intervalTargetMin_ _intervalTargetMax_;
11456  retain _intervalTargetMin_ .;
11457  retain _intervalTargetMax_ .;
11458  if (_n_ = 1) then do;
11459  _intervalTargetMin_ = P_Age;
11460  _intervalTargetMax_ = P_Age;
11461  end;
11462  else do;
11463  if (_intervalTargetMin_ > P_Age) then do;
11464  _intervalTargetMin_ = P_Age;
11465  end;
11466  if (_intervalTargetMax_ < P_Age) then do;
11467  _intervalTargetMax_ = P_Age;
11468  end;
11469  end;
11470  if _lastObservation_ then do;
11471  output work.ASSESS_29EHERW_meansAndTi_ajLJtX;
11472  end;
11473  run;

NOTE: There were 140 observations read from the data set EMWS1.HPDMFOREST_TRAIN.
      WHERE (Age not = .) and (P_Age not = .);
NOTE: The data set WORK.ASSESS_29EHERW_NORMSD_JGIJNF has 140 observations and 3 variables.
NOTE: The data set WORK.ASSESS_29EHERW_MEANSANDTI_AJLJTX has 1 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11474  data WORK._EMRANK;
11475  set EMWS1.MdlComp_EMRANK;
11476  where MODEL = "HPDMForest" and TARGET = "Age" and dataRole="TRAIN";
11477  run;

NOTE: There were 20 observations read from the data set EMWS1.MDLCOMP_EMRANK.
      WHERE (MODEL='HPDMForest') and (TARGET='Age') and (dataRole='TRAIN');
NOTE: The data set WORK._EMRANK has 20 observations and 15 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11478  data work._augment;
11479  do BIN= 1 to 20;
11480  DECILE = BIN*5;
11481  output;
11482  end;
11483  run;

NOTE: The data set WORK._AUGMENT has 20 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11484  data WORK._EMRANK;
11485  merge WORK._AUGMENT WORK._EMRANK;
11486  by BIN;
11487  run;

NOTE: There were 20 observations read from the data set WORK._AUGMENT.
NOTE: There were 20 observations read from the data set WORK._EMRANK.
NOTE: The data set WORK._EMRANK has 20 observations and 15 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11488  data WORK._EMRANK;
11489  set WORK._EMRANK end=_lastObservation_;
11490  retain _previousMinP_ _previousMaxP_;
11491  retain _group_ 1;
11492  keep bin _cutoff_ _group_;
11493  if (bin > 1) then do;
11494  bin = bin - 1;
11495  _cutoff_ = (_maxP_ + _previousMinP_) / 2;
11496  if (abs(_previousMaxP_ - _previousMinP_) < 1E-6) then do;
11497  /* tied */
11498  _cutoff_ = max((_minP_ + _maxP_)/2, min(_cutoff_, _previousMinP_/*-1E-6*/
11499  ));
11500  end;
11501  else if (abs(_maxP_ - _minP_) < 1E-6) then do;
11502  /* next tied */
11503  _cutoff_ = min((_previousMinP_ + _previousMaxP_)/2, max(_cutoff_, _maxP_/*+ 1E-6*/
11504  ));
11505  end;
11506  output;
11507  *if ( abs((_maxP_ +_minP_)/2 - (_previousMaxP_ + _previousMinP_)/2) > 1E-6) then do;
11508  * _group_ + 1;
11509  *end;
11510  if (_maxP_ le _previousMinP_ - 1E-6) then do;
11511  _group_ + 1;
11512  end;
11513  else if (abs(_maxP_ - _previousMinP_) < 1E-6) then do;
11514  if (abs(_maxP_ - _minP_) > 1E-6) then do;
11515  _group_ + 1;
11516  end;
11517  end;
11518  bin + 1;
11519  /* correct the previous change */
11520  end;
11521  if (_lastObservation_) then do;
11522  _cutoff_ = .;
11523  output;
11524  end;
11525  _previousMinP_ = _minP_;
11526  _previousMaxP_ = _maxP_;
11527  run;

NOTE: There were 20 observations read from the data set WORK._EMRANK.
NOTE: The data set WORK._EMRANK has 20 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11528  data WORK._EMRANK;
11529  set WORK._EMRANK;
11530  by _group_;
11531  retain _start_;
11532  if (first._group_) then do;
11533  _start_ = _n_;
11534  end;
11535  if (last._group_) then do;
11536  _end_ = _n_;
11537  output;
11538  end;
11539  run;

NOTE: There were 20 observations read from the data set WORK._EMRANK.
NOTE: The data set WORK._EMRANK has 20 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
11540  filename emflow "C:\Users\Administrator\Desktop\NewProjectExam\Workspaces\EMWS1\MdlComp\EMFLOWSCORE.sas";
11541  *------------------------------------------------------------*;
11542  * MdlComp: Scoring HPDMFOREST_TRAIN data;
11543  *------------------------------------------------------------*;
11544  data EMWS1.MdlComp_TRAIN
11545  / view=EMWS1.MdlComp_TRAIN
11546  ;
11547  set EMWS1.HPDMForest_TRAIN
11548  ;
11549  %inc emflow;
11629  run;

NOTE: DATA STEP view saved on file EMWS1.MDLCOMP_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11630  quit;
11631  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.

11632  filename emflow "C:\Users\Administrator\Desktop\NewProjectExam\Workspaces\EMWS1\MdlComp\EMFLOWSCORE.sas";
11633  *------------------------------------------------------------*;
11634  * MdlComp: Scoring HPDMFOREST_VALIDATE data;
11635  *------------------------------------------------------------*;
11636  data EMWS1.MdlComp_VALIDATE
11637  / view=EMWS1.MdlComp_VALIDATE
11638  ;
11639  set EMWS1.HPDMForest_VALIDATE
11640  ;
11641  %inc emflow;
11721  run;

NOTE: DATA STEP view saved on file EMWS1.MDLCOMP_VALIDATE.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11722  quit;
11723  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.

11724  filename emflow "C:\Users\Administrator\Desktop\NewProjectExam\Workspaces\EMWS1\MdlComp\EMFLOWSCORE.sas";
11725  *------------------------------------------------------------*;
11726  * MdlComp: Scoring HPDMFOREST_TEST data;
11727  *------------------------------------------------------------*;
11728  data EMWS1.MdlComp_TEST
11729  / view=EMWS1.MdlComp_TEST
11730  ;
11731  set EMWS1.HPDMForest_TEST
11732  ;
11733  %inc emflow;
11813  run;

NOTE: DATA STEP view saved on file EMWS1.MDLCOMP_TEST.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11814  quit;
11815  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.

11816  *------------------------------------------------------------*;
11817  * MdlComp: Computing metadata for TRAIN data;
11818  *------------------------------------------------------------*;

NOTE: View EMWS1.MDLCOMP_TRAIN.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
NOTE: View EMWS1.MDLCOMP_TRAIN.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      
NOTE: View EMWS1.MDLCOMP_VALIDATE.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      
NOTE: View EMWS1.MDLCOMP_TEST.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.03 seconds
      
